(function(){"use strict";var e={8487:function(e,n,t){var o=t(3751),a=t(641);const r={id:"app"};function s(e,n,t,o,s,l){const c=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("main",null,[(0,a.bF)(c)])])}var l={name:"App"},c=t(6262);const i=(0,c.A)(l,[["render",s]]);var u=i,d=t(5220),p=(t(4114),t(953)),v=t(4335),h=t(33);const f=e=>((0,a.Qi)("data-v-23b8c7fe"),e=e(),(0,a.jt)(),e),m={class:"calendar-sidebar"},g={class:"nav-buttons"},b={class:"calendar"},y={class:"weekdays"},k={class:"days"},w=f((()=>(0,a.Lk)("input",{type:"text",placeholder:"搜索日程...",class:"search-input"},null,-1)));function C(e,n,t,o,r,s){return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",g,[(0,a.Lk)("button",{onClick:n[0]||(n[0]=(...n)=>e.previousMonth&&e.previousMonth(...n))},"<"),(0,a.Lk)("span",null,(0,h.v_)(e.currentMonthYear),1),(0,a.Lk)("button",{onClick:n[1]||(n[1]=(...n)=>e.nextMonth&&e.nextMonth(...n))},">")]),(0,a.Lk)("div",b,[(0,a.Lk)("div",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.weekdays,(e=>((0,a.uX)(),(0,a.CE)("span",{key:e},(0,h.v_)(e),1)))),128))]),(0,a.Lk)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.calendarDays,(e=>((0,a.uX)(),(0,a.CE)("span",{key:e.date,class:(0,h.C4)({"current-day":e.isToday,"other-month":!e.isCurrentMonth})},(0,h.v_)(e.date),3)))),128))])]),w])}var I={name:"CalendarSidebar",setup(){const e=(0,p.KR)(new Date),n=["日","一","二","三","四","五","六"],t=(0,a.EW)((()=>`${e.value.getFullYear()}年${e.value.getMonth()+1}月`)),o=(0,a.EW)((()=>[]));function r(){e.value=new Date(e.value.getFullYear(),e.value.getMonth()-1,1)}function s(){e.value=new Date(e.value.getFullYear(),e.value.getMonth()+1,1)}return{currentMonthYear:t,weekdays:n,calendarDays:o,previousMonth:r,nextMonth:s}}};const L=(0,c.A)(I,[["render",C],["__scopeId","data-v-23b8c7fe"]]);var S=L;const _={class:"family-tabs"},E=["onClick"];function A(e,n,t,o,r,s){return(0,a.uX)(),(0,a.CE)("div",_,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.familyMembers,(n=>((0,a.uX)(),(0,a.CE)("button",{key:n.id,class:(0,h.C4)(["member-tab",{active:n.id===e.activeMember}]),onClick:t=>e.setActiveMember(n.id)},(0,h.v_)(n.name),11,E)))),128)),(0,a.Lk)("button",{class:"add-event-btn",onClick:n[0]||(n[0]=(...n)=>e.addEvent&&e.addEvent(...n))},"+ 添加日程")])}var M={name:"FamilyTabs",setup(){const e=(0,p.KR)([{id:"all",name:"全家"},{id:"dad",name:"爸爸"},{id:"mom",name:"妈妈"},{id:"son",name:"弟弟"},{id:"daughter",name:"姐姐"},{id:"grandma",name:"阿姨"}]),n=(0,p.KR)("all");function t(e){n.value=e}function o(){console.log("添加新事件")}return{familyMembers:e,activeMember:n,setActiveMember:t,addEvent:o}}};const T=(0,c.A)(M,[["render",A],["__scopeId","data-v-48ba655a"]]);var F=T;const K={class:"schedule-view"},X={class:"time-column"},j={class:"events-column"};var O={__name:"ScheduleView",props:{events:{type:Array,required:!0}},setup(e){const n=[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22];function t(e){return`${e.toString().padStart(2,"0")}:00`}function o(e){return`${e.startDate.split("T")[1].slice(0,5)} - ${e.endDate.split("T")[1].slice(0,5)}`}function r(e){const n=parseInt(e.startDate.split("T")[1].split(":")[0]),t=parseInt(e.startDate.split("T")[1].split(":")[1]),o=parseInt(e.endDate.split("T")[1].split(":")[0]),a=parseInt(e.endDate.split("T")[1].split(":")[1]),r=60*(n-6+t/60),s=60*(o-n+(a-t)/60);return{top:`${r}px`,height:`${s}px`}}return(s,l)=>((0,a.uX)(),(0,a.CE)("div",K,[(0,a.Lk)("div",X,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(n,(e=>(0,a.Lk)("div",{key:e,class:"time-slot"},(0,h.v_)(t(e)),1))),64))]),(0,a.Lk)("div",j,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(n,(e=>(0,a.Lk)("div",{key:e,class:"event-slot"}))),64)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.events,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"event",style:(0,h.Tr)(r(e))},[(0,a.Lk)("h3",null,(0,h.v_)(e.title),1),(0,a.Lk)("p",null,(0,h.v_)(o(e)),1)],4)))),128))])]))}};const D=(0,c.A)(O,[["__scopeId","data-v-c9631ba6"]]);var W=D;const $={class:"current-date-time"};var x={__name:"CurrentDateTime",setup(e){const n=(0,p.KR)("");function t(){const e=new Date,t=e.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),o=e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});n.value=`${t} ${o}`}let o;return(0,a.sV)((()=>{t(),o=setInterval(t,6e4)})),(0,a.hi)((()=>{clearInterval(o)})),(e,t)=>((0,a.uX)(),(0,a.CE)("div",$,(0,h.v_)(n.value),1))}};const P=(0,c.A)(x,[["__scopeId","data-v-80a1425c"]]);var R=P;const N=e=>((0,a.Qi)("data-v-2484e434"),e=e(),(0,a.jt)(),e),U={class:"home-view"},V={class:"header"},q=N((()=>(0,a.Lk)("h1",null,"家庭日程",-1))),z={class:"layout"},Y={class:"main-content"};var J={__name:"HomeView",setup(e){const n=(0,p.KR)([]);let t,o=!1;const r=()=>{const e="wss://family.aibigboom.com/ws";console.log("尝试连接到 WebSocket:",e),t=new WebSocket(e),t.onopen=()=>{console.log("WebSocket 连接已建立"),o=!1},t.onmessage=e=>{console.log("收到 WebSocket 消息:",e.data);try{const t=JSON.parse(e.data);"initial"===t.type?n.value=t.events:"newEvent"===t.type&&n.value.push(t.event)}catch(t){console.error("处理 WebSocket 消息时出错:",t)}},t.onerror=e=>{console.error("WebSocket 错误:",e),console.log("WebSocket 读取状态:",t.readyState),console.log("WebSocket URL:",t.url),o||(console.log("切换到轮询模式"),s())},t.onclose=e=>{console.log(`WebSocket 连接关闭。代码: ${e.code}, 原因: ${e.reason}`),o||(console.log("5秒后尝试重新连接..."),setTimeout(r,5e3))}},s=async()=>{if(o)return;o=!0;const e=async()=>{try{const e=await v.A.get("/api/events");n.value=e.data,console.log("通过轮询获取到事件:",n.value)}catch(t){console.error("轮询错误:",t)}o&&setTimeout(e,5e3)};e()};return(0,a.sV)((()=>{r()})),(0,a.hi)((()=>{t&&t.close(),o=!1})),(e,t)=>((0,a.uX)(),(0,a.CE)("div",U,[(0,a.Lk)("div",V,[q,(0,a.bF)(R)]),(0,a.Lk)("div",z,[(0,a.bF)(S),(0,a.Lk)("div",Y,[(0,a.bF)(F),(0,a.bF)(W,{events:n.value},null,8,["events"])])])]))}};const Q=(0,c.A)(J,[["__scopeId","data-v-2484e434"]]);var B=Q;const G={class:"schedule-input-view"};function H(e,n,t,r,s,l){return(0,a.uX)(),(0,a.CE)("div",G,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":n[0]||(n[0]=e=>s.scheduleInput=e),placeholder:"输入您的日程安排...",rows:"4"},null,512),[[o.Jo,s.scheduleInput]]),(0,a.Lk)("button",{onClick:n[1]||(n[1]=(...e)=>l.submitSchedule&&l.submitSchedule(...e))},"提交日程")])}var Z={name:"ScheduleInputView",data(){return{scheduleInput:"",apiKey:"app-zyuogN6iPjys8j4R7fTj8M2z",apiUrl:"https://api.dify.ai/v1/workflows/run"}},methods:{async submitSchedule(){try{console.log("正在发送请求..."),console.log("API URL:",this.apiUrl),console.log("API Key:",this.apiKey);const e={inputs:{user_input:this.scheduleInput}};console.log("请求体:",JSON.stringify(e));const n=await v.A.post(this.apiUrl,e,{headers:{"Content-Type":"application/json",Authorization:this.apiKey}});console.log("日程提交成功:",n.data)}catch(e){console.error("提交日程时出错:",e),e.response?(console.error("错误数据:",e.response.data),console.error("错误状态:",e.response.status),console.error("错误头部:",e.response.headers)):e.request?console.error("未收到响应:",e.request):console.error("错误信息:",e.message),console.error("错误配置:",e.config)}}},mounted(){console.log("组件已挂载"),console.log("API URL:",this.apiUrl),console.log("API Key:",this.apiKey)}};const ee=(0,c.A)(Z,[["render",H],["__scopeId","data-v-10924b80"]]);var ne=ee;const te=[{path:"/",name:"home",component:B},{path:"/schedule-input",name:"scheduleInput",component:ne}],oe=(0,d.aE)({history:(0,d.LA)("/"),routes:te});var ae=oe,re=t(3723);(0,re.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(e){console.log("Service worker has been registered."),setInterval((()=>{e.update()}),36e5)},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(e){console.log("New content is available; please refresh.");const n=e.waiting;window.confirm("新版本可用。是否刷新页面？")&&(n.postMessage({type:"SKIP_WAITING"}),window.location.reload())},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),v.A.defaults.baseURL="https://family.aibigboom.com";const se=(0,o.Ef)(u);se.use(ae);const le=()=>{"wakeLock"in navigator?navigator.wakeLock.request("screen").then((()=>{console.log("Screen will stay awake")})).catch((e=>{console.error(`${e.name}, ${e.message}`)})):console.warn("Wake Lock API not supported")};se.mount("#app"),le()}},n={};function t(o){var a=n[o];if(void 0!==a)return a.exports;var r=n[o]={exports:{}};return e[o].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(n,o,a,r){if(!o){var s=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],r=e[u][2];for(var l=!0,c=0;c<o.length;c++)(!1&r||s>=r)&&Object.keys(t.O).every((function(e){return t.O[e](o[c])}))?o.splice(c--,1):(l=!1,r<s&&(s=r));if(l){e.splice(u--,1);var i=a();void 0!==i&&(n=i)}}return n}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,a,r]}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var a,r,s=o[0],l=o[1],c=o[2],i=0;if(s.some((function(n){return 0!==e[n]}))){for(a in l)t.o(l,a)&&(t.m[a]=l[a]);if(c)var u=c(t)}for(n&&n(o);i<s.length;i++)r=s[i],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(u)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(8487)}));o=t.O(o)})();
//# sourceMappingURL=app.9c3ec4a8.js.map