(function(){"use strict";var e={4118:function(e,t,n){var o=n(3751),s=n(641);const a={id:"app"};function r(e,t,n,o,r,l){const i=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",a,[(0,s.Lk)("main",null,[(0,s.bF)(i)])])}var l={name:"App"},i=n(6262);const c=(0,i.A)(l,[["render",r]]);var u=c,d=n(5220),p=(n(4114),n(953)),v=n(4335),h=n(33);const m=e=>((0,s.Qi)("data-v-23b8c7fe"),e=e(),(0,s.jt)(),e),f={class:"calendar-sidebar"},g={class:"nav-buttons"},b={class:"calendar"},k={class:"weekdays"},y={class:"days"},w=m((()=>(0,s.Lk)("input",{type:"text",placeholder:"搜索日程...",class:"search-input"},null,-1)));function I(e,t,n,o,a,r){return(0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("div",g,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.previousMonth&&e.previousMonth(...t))},"<"),(0,s.Lk)("span",null,(0,h.v_)(e.currentMonthYear),1),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...t)=>e.nextMonth&&e.nextMonth(...t))},">")]),(0,s.Lk)("div",b,[(0,s.Lk)("div",k,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.weekdays,(e=>((0,s.uX)(),(0,s.CE)("span",{key:e},(0,h.v_)(e),1)))),128))]),(0,s.Lk)("div",y,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.calendarDays,(e=>((0,s.uX)(),(0,s.CE)("span",{key:e.date,class:(0,h.C4)({"current-day":e.isToday,"other-month":!e.isCurrentMonth})},(0,h.v_)(e.date),3)))),128))])]),w])}var C={name:"CalendarSidebar",setup(){const e=(0,p.KR)(new Date),t=["日","一","二","三","四","五","六"],n=(0,s.EW)((()=>`${e.value.getFullYear()}年${e.value.getMonth()+1}月`)),o=(0,s.EW)((()=>[]));function a(){e.value=new Date(e.value.getFullYear(),e.value.getMonth()-1,1)}function r(){e.value=new Date(e.value.getFullYear(),e.value.getMonth()+1,1)}return{currentMonthYear:n,weekdays:t,calendarDays:o,previousMonth:a,nextMonth:r}}};const L=(0,i.A)(C,[["render",I],["__scopeId","data-v-23b8c7fe"]]);var S=L;const _={class:"family-tabs"},E=["onClick"];function A(e,t,n,o,a,r){return(0,s.uX)(),(0,s.CE)("div",_,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.familyMembers,(t=>((0,s.uX)(),(0,s.CE)("button",{key:t.id,class:(0,h.C4)(["member-tab",{active:t.id===e.activeMember}]),onClick:n=>e.setActiveMember(t.id)},(0,h.v_)(t.name),11,E)))),128)),(0,s.Lk)("button",{class:"add-event-btn",onClick:t[0]||(t[0]=(...t)=>e.addEvent&&e.addEvent(...t))},"+ 添加日程")])}var M={name:"FamilyTabs",setup(){const e=(0,p.KR)([{id:"all",name:"全家"},{id:"dad",name:"爸爸"},{id:"mom",name:"妈妈"},{id:"son",name:"弟弟"},{id:"daughter",name:"姐姐"},{id:"grandma",name:"阿姨"}]),t=(0,p.KR)("all");function n(e){t.value=e}function o(){console.log("添加新事件")}return{familyMembers:e,activeMember:t,setActiveMember:n,addEvent:o}}};const T=(0,i.A)(M,[["render",A],["__scopeId","data-v-48ba655a"]]);var F=T;const X={class:"schedule-view"},O={class:"time-column"},j={class:"events-column"};var K={__name:"ScheduleView",props:{events:{type:Array,required:!0}},setup(e){const t=[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22];function n(e){return`${e.toString().padStart(2,"0")}:00`}function o(e){return`${e.startDate.split("T")[1].slice(0,5)} - ${e.endDate.split("T")[1].slice(0,5)}`}function a(e){const t=parseInt(e.startDate.split("T")[1].split(":")[0]),n=parseInt(e.startDate.split("T")[1].split(":")[1]),o=parseInt(e.endDate.split("T")[1].split(":")[0]),s=parseInt(e.endDate.split("T")[1].split(":")[1]),a=60*(t-6+n/60),r=60*(o-t+(s-n)/60);return{top:`${a}px`,height:`${r}px`}}return(r,l)=>((0,s.uX)(),(0,s.CE)("div",X,[(0,s.Lk)("div",O,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(t,(e=>(0,s.Lk)("div",{key:e,class:"time-slot"},(0,h.v_)(n(e)),1))),64))]),(0,s.Lk)("div",j,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(t,(e=>(0,s.Lk)("div",{key:e,class:"event-slot"}))),64)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.events,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"event",style:(0,h.Tr)(a(e))},[(0,s.Lk)("h3",null,(0,h.v_)(e.title),1),(0,s.Lk)("p",null,(0,h.v_)(o(e)),1)],4)))),128))])]))}};const D=(0,i.A)(K,[["__scopeId","data-v-c9631ba6"]]);var $=D;const x={class:"current-date-time"};var W={__name:"CurrentDateTime",setup(e){const t=(0,p.KR)("");function n(){const e=new Date,n=e.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),o=e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});t.value=`${n} ${o}`}let o;return(0,s.sV)((()=>{n(),o=setInterval(n,6e4)})),(0,s.hi)((()=>{clearInterval(o)})),(e,n)=>((0,s.uX)(),(0,s.CE)("div",x,(0,h.v_)(t.value),1))}};const N=(0,i.A)(W,[["__scopeId","data-v-80a1425c"]]);var P=N;const R=e=>((0,s.Qi)("data-v-2484e434"),e=e(),(0,s.jt)(),e),U={class:"home-view"},V={class:"header"},q=R((()=>(0,s.Lk)("h1",null,"家庭日程",-1))),z={class:"layout"},J={class:"main-content"};var Y={__name:"HomeView",setup(e){const t=(0,p.KR)([]);let n,o=!1;const a=()=>{const e="wss://family.aibigboom.com/ws";console.log("尝试连接到 WebSocket:",e),n=new WebSocket(e),n.onopen=()=>{console.log("WebSocket 连接已建立"),o=!1},n.onmessage=e=>{console.log("收到 WebSocket 消息:",e.data);try{const n=JSON.parse(e.data);"initial"===n.type?t.value=n.events:"newEvent"===n.type&&t.value.push(n.event)}catch(n){console.error("处理 WebSocket 消息时出错:",n)}},n.onerror=e=>{console.error("WebSocket 错误:",e),console.log("WebSocket 读取状态:",n.readyState),console.log("WebSocket URL:",n.url),o||(console.log("切换到轮询模式"),r())},n.onclose=e=>{console.log(`WebSocket 连接关闭。代码: ${e.code}, 原因: ${e.reason}`),o||(console.log("5秒后尝试重新连接..."),setTimeout(a,5e3))}},r=async()=>{if(o)return;o=!0;const e=async()=>{try{const e=await v.A.get("/api/events");t.value=e.data,console.log("通过轮询获取到事件:",t.value)}catch(n){console.error("轮询错误:",n)}o&&setTimeout(e,5e3)};e()};return(0,s.sV)((()=>{a()})),(0,s.hi)((()=>{n&&n.close(),o=!1})),(e,n)=>((0,s.uX)(),(0,s.CE)("div",U,[(0,s.Lk)("div",V,[q,(0,s.bF)(P)]),(0,s.Lk)("div",z,[(0,s.bF)(S),(0,s.Lk)("div",J,[(0,s.bF)(F),(0,s.bF)($,{events:t.value},null,8,["events"])])])]))}};const Q=(0,i.A)(Y,[["__scopeId","data-v-2484e434"]]);var B=Q;const G=e=>((0,s.Qi)("data-v-94904c4a"),e=e(),(0,s.jt)(),e),H={class:"schedule-input-view"},Z=G((()=>(0,s.Lk)("h2",null,"日程安排输入",-1))),ee={key:0,class:"response-area"},te=G((()=>(0,s.Lk)("h3",null,"响应：",-1)));function ne(e,t,n,a,r,l){return(0,s.uX)(),(0,s.CE)("div",H,[Z,(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.scheduleInput=e),placeholder:"输入您的日程安排...",rows:"4"},null,512),[[o.Jo,r.scheduleInput]]),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.submitSchedule&&l.submitSchedule(...e))},"提交日程"),r.response?((0,s.uX)(),(0,s.CE)("div",ee,[te,(0,s.Lk)("pre",null,(0,h.v_)(r.response),1)])):(0,s.Q3)("",!0)])}var oe={name:"ScheduleInputView",data(){return{scheduleInput:"",apiKey:"app-zyuogN6iPjys8j4R7fTj8M2z",apiUrl:"https://api.dify.ai/v1/workflows/run",userId:"user-123",response:null}},methods:{async submitSchedule(){try{console.log("正在发送请求..."),console.log("API URL:",this.apiUrl),console.log("App ID:",this.appId),console.log("API Key (前5个字符):",this.apiKey.substring(0,5));const e={inputs:{text:this.scheduleInput},response_mode:"blocking",user:this.userId};console.log("请求体:",JSON.stringify(e));const t=await(0,v.A)({method:"post",url:this.apiUrl,data:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey.trim()}`},params:{app_id:this.appId}});console.log("响应:",t.data),this.response=JSON.stringify(t.data,null,2)}catch(e){console.error("提交日程时出错:",e.message),e.response?(console.error("错误数据:",e.response.data),console.error("错误状态:",e.response.status),console.error("错误头部:",e.response.headers),this.response="错误: "+JSON.stringify(e.response.data,null,2)):e.request?(console.error("未收到响应:",e.request),this.response="错误: 未收到服务器响应"):this.response="错误: "+e.message}},handleStreamEvent(e){console.log("收到事件:",e)}}};const se=(0,i.A)(oe,[["render",ne],["__scopeId","data-v-94904c4a"]]);var ae=se;const re=[{path:"/",name:"home",component:B},{path:"/schedule-input",name:"scheduleInput",component:ae}],le=(0,d.aE)({history:(0,d.LA)("/"),routes:re});var ie=le,ce=n(3723);(0,ce.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(e){console.log("Service worker has been registered."),setInterval((()=>{e.update()}),36e5)},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(e){console.log("New content is available; please refresh.");const t=e.waiting;window.confirm("新版本可用。是否刷新页面？")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),v.A.defaults.baseURL="https://family.aibigboom.com";const ue=(0,o.Ef)(u);ue.use(ie);const de=()=>{"wakeLock"in navigator?navigator.wakeLock.request("screen").then((()=>{console.log("Screen will stay awake")})).catch((e=>{console.error(`${e.name}, ${e.message}`)})):console.warn("Wake Lock API not supported")};ue.mount("#app"),de()}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,s,a){if(!o){var r=1/0;for(u=0;u<e.length;u++){o=e[u][0],s=e[u][1],a=e[u][2];for(var l=!0,i=0;i<o.length;i++)(!1&a||r>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(l=!1,a<r&&(r=a));if(l){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[o,s,a]}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,a,r=o[0],l=o[1],i=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(s in l)n.o(l,s)&&(n.m[s]=l[s]);if(i)var u=i(n)}for(t&&t(o);c<r.length;c++)a=r[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(4118)}));o=n.O(o)})();
//# sourceMappingURL=app.1593fa23.js.map